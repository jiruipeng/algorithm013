学习笔记

## HashMap

- 基于哈希表的 Map 接口实现。



两个影响性能的参数：

1. 初始容量
2. 负载因子



### 哈希表

- 对象数组 + 链表
- 哈希桶：对象数组中每个元素可以看做一个桶，每个桶里存储的是链表。链表的长度大于8的时候链表会转化为红黑二叉树，元素个数少于6时，会从红黑二叉树转化为链表。
- 问：当哈希桶里的链表长度为7，减少到6时，会不会转化为链表？
  这个问题没有明确哈希桶中元素个数长度为7时，其状态是红黑二叉树还是链表，如果是链表，减少到6时，自然不需要转化的操作。

### HashCode

- 每个类都有自己的哈希值。

- 🔲尝试自己实现哈希值的计算

### 源码分析

插入数据流程图

![image.png](https://cdn.nlark.com/yuque/0/2020/png/574772/1595303871981-0489de6c-5b3e-4994-8901-d9626f01ef92.png)



计算哈希值：计算的是键的哈希值，所以一个键值对存在哪里，是有键决定的，而不是值。

![image.png](https://cdn.nlark.com/yuque/0/2020/png/574772/1595303400282-ab876792-8d18-4fd2-8583-ff6c3bb754ca.png)

取余的一种计算方法，更快。计算后得到下标

![image.png](https://cdn.nlark.com/yuque/0/2020/png/574772/1595303622991-03287f7c-bee0-410a-9666-78e4dd063b6c.png)

# Iterator（迭代器）

- 迭代器可分为“快速失败的”和“安全失败的”
  快速失败：遍历过程中，如果其他线程修改了集合，除了通过迭代器自身的 remove 方法外，迭代器将抛出异常。
  安全失败：迭代器迭代前复制了一份集合内容，修改集合不影响。